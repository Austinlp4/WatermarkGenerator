{
  "schemaVersion": 2,
  "dockerfileLines": [
    "FROM golang:1.21-alpine",
    "RUN apk add --no-cache gcc musl-dev nodejs npm",
    "WORKDIR /",
    "COPY . .",
    "WORKDIR /frontend",
    "RUN npm ci --only=production",
    "RUN npm install --no-save vite typescript @vitejs/plugin-react",
    "RUN NODE_OPTIONS=--max_old_space_size=2048 npm run build || true",
    "WORKDIR /",
    "RUN go build -o watermark-generator",
    "EXPOSE 8080",
    "CMD [\"./watermark-generator\"]"
  ]
}